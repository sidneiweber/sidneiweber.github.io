<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="ie=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=author content="Sidnei Weber">
<meta name=description content="Na [parte 1](https://sidneiweber.com.br/ansible-criado-ami-windows-personalizada-na-aws-parte-1/) aprendemos como usar um script AWS User Data para configurar uma senha de Administrador e configurar o WinRM no Windows. Agora que sabemos como criar uma instância setando um senha especifica, vamos ao restante dos procedimentos.  Vamos estruturar nosso projeto e manter as coisas organizadas.">
<meta name=keywords content=",aws,ansible,windows">
<meta name=robots content="noodp">
<meta name=theme-color content>
<link rel=canonical href=https://sidneiweber.github.io/ansible-criado-ami-windows-personalizada-na-aws-parte-2/>
<title>
Ansible: Criado AMI Windows personalizada na AWS (Parte 2) :: Sidnei Weber — Hello Friend NG Theme
</title>
<link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css>
<link rel=stylesheet href=https://sidneiweber.github.io/main.de188b3201233c251f4fd6306dbd2cb41e408fb8846c09781b2925de7df5025c.css>
<link rel=apple-touch-icon sizes=180x180 href=https://sidneiweber.github.io/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=https://sidneiweber.github.io/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=https://sidneiweber.github.io/favicon-16x16.png>
<link rel=manifest href=https://sidneiweber.github.io/site.webmanifest>
<link rel=mask-icon href=https://sidneiweber.github.io/safari-pinned-tab.svg color=#1b1c1d>
<link rel="shortcut icon" href=https://sidneiweber.github.io/favicon.ico>
<meta name=msapplication-TileColor content="#1b1c1d">
<meta name=theme-color content="#1b1c1d">
<meta itemprop=name content="Ansible: Criado AMI Windows personalizada na AWS (Parte 2)">
<meta itemprop=description content="Na [parte 1](https://sidneiweber.com.br/ansible-criado-ami-windows-personalizada-na-aws-parte-1/) aprendemos como usar um script AWS User Data para configurar uma senha de Administrador e configurar o WinRM no Windows. Agora que sabemos como criar uma instância setando um senha especifica, vamos ao restante dos procedimentos.  Vamos estruturar nosso projeto e manter as coisas organizadas."><meta itemprop=datePublished content="2019-12-27T17:04:43+00:00">
<meta itemprop=dateModified content="2019-12-27T17:04:43+00:00">
<meta itemprop=wordCount content="955"><meta itemprop=image content="https://sidneiweber.github.io">
<meta itemprop=keywords content="aws,ansible,windows,">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://sidneiweber.github.io">
<meta name=twitter:title content="Ansible: Criado AMI Windows personalizada na AWS (Parte 2)">
<meta name=twitter:description content="Na [parte 1](https://sidneiweber.com.br/ansible-criado-ami-windows-personalizada-na-aws-parte-1/) aprendemos como usar um script AWS User Data para configurar uma senha de Administrador e configurar o WinRM no Windows. Agora que sabemos como criar uma instância setando um senha especifica, vamos ao restante dos procedimentos.  Vamos estruturar nosso projeto e manter as coisas organizadas.">
<meta property="og:title" content="Ansible: Criado AMI Windows personalizada na AWS (Parte 2)">
<meta property="og:description" content="Na [parte 1](https://sidneiweber.com.br/ansible-criado-ami-windows-personalizada-na-aws-parte-1/) aprendemos como usar um script AWS User Data para configurar uma senha de Administrador e configurar o WinRM no Windows. Agora que sabemos como criar uma instância setando um senha especifica, vamos ao restante dos procedimentos.  Vamos estruturar nosso projeto e manter as coisas organizadas.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://sidneiweber.github.io/ansible-criado-ami-windows-personalizada-na-aws-parte-2/"><meta property="og:image" content="https://sidneiweber.github.io"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2019-12-27T17:04:43+00:00">
<meta property="article:modified_time" content="2019-12-27T17:04:43+00:00">
<meta property="article:published_time" content="2019-12-27 17:04:43 +0000 UTC">
</head>
<body>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=https://sidneiweber.github.io/ style=text-decoration:none>
<div class=logo>
<span class=logo__mark>></span>
<span class=logo__text>$ cd /home/sidnei</span>
<span class=logo__cursor>
</span>
</div>
</a>
<span class=header__right>
<nav class=menu>
<ul class=menu__inner><li><a href=https://sidneiweber.github.io/about/>About</a></li><li><a href=https://sidneiweber.github.io/password-generator>Password Generator</a></li><li><a href=https://sidneiweber.github.io/posts/>Posts</a></li><li><a href=https://sidneiweber.github.io/index.xml>RSS</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<main class=post>
<div class=post-info>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
5 minutes
</p>
</div>
<article>
<h1 class=post-title>
<a href=https://sidneiweber.github.io/ansible-criado-ami-windows-personalizada-na-aws-parte-2/>Ansible: Criado AMI Windows personalizada na AWS (Parte 2)</a>
</h1>
<div class=post-excerpt>Na [parte 1](https://sidneiweber.com.br/ansible-criado-ami-windows-personalizada-na-aws-parte-1/) aprendemos como usar um script AWS User Data para configurar uma senha de Administrador e configurar o WinRM no Windows. Agora que sabemos como criar uma instância setando um senha especifica, vamos ao restante dos procedimentos. Vamos estruturar nosso projeto e manter as coisas organizadas.</div>
<div class=post-content>
<p>Na <a href=https://sidneiweber.com.br/ansible-criado-ami-windows-personalizada-na-aws-parte-1/>parte 1</a> aprendemos como usar um script AWS User Data para configurar uma senha de Administrador e configurar o WinRM no Windows. Agora que sabemos como criar uma instância setando um senha especifica, vamos ao restante dos procedimentos. Vamos estruturar nosso projeto e manter as coisas organizadas.</p>
<p>Recursos utilizados, caso não tenha algo instalado, não funcionará :</p>
<p><strong>Python 3.8.0</strong>
<strong>Módulos pip</strong>:</p>
<ul>
<li>boto</li>
<li>boto3</li>
<li>pywinrm</li>
</ul>
<p><strong>Ansible 2.9.2</strong></p>
<p>Já podemos supor que você tenha o Ansible configurado corretamente para sua conta da AWS (por exemplo, boto instalado, credenciais do IAM configuradas). Consulte o Guia da AWS da Ansible se precisar de ajuda para fazer isso. Por simplicidade, esses exemplos também pressupõem que você tenha uma VPC padrão funcional em sua região (você deve ter, a menos que a tenha excluído). Se você precisar de ajuda para configurar isso, consulte a página da Amazon em VPCs padrão.</p>
<p>Caso queira ir direto para os arquivos usados, pode acessar no github: <a href=https://github.com/sidneiweber/ansible-windows-ami>https://github.com/sidneiweber/ansible-windows-ami</a></p>
<p>Vamos iniciar pelas nossas variáveis, onde vamos setar a região da AWS, o tipo de instância, nossa chave, vpc e subnet, nossa senha que usamos na <a href=https://sidneiweber.com.br/ansible-criado-ami-windows-personalizada-na-aws-parte-1/>primeira parte </a> do artigo e alguns detalhes sobre os volumes:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#75715e># cat group_vars/all.yml</span>
<span style=color:#f92672>target_aws_region</span>: <span style=color:#ae81ff>us-east-1</span>
<span style=color:#f92672>instance_type</span>: <span style=color:#ae81ff>t3.small</span>
<span style=color:#f92672>keypair</span>: <span style=color:#ae81ff>keypair</span>
<span style=color:#f92672>vpc_id</span>: <span style=color:#ae81ff>vpc-xxxxx</span>
<span style=color:#f92672>subnet</span>: <span style=color:#ae81ff>subnet-xxxxx</span>
<span style=color:#f92672>win_initial_password</span>: <span style=color:#ae81ff>myTempPassword123!</span>
<span style=color:#f92672>volumes</span>:
  - <span style=color:#f92672>device_name</span>: <span style=color:#ae81ff>/dev/sda1</span>
    <span style=color:#f92672>device_type</span>: <span style=color:#ae81ff>gp2</span>
    <span style=color:#f92672>volume_size</span>: <span style=color:#ae81ff>30</span>
    <span style=color:#f92672>delete_on_termination</span>: <span style=color:#66d9ef>true</span>
</code></pre></div><p>Nosso arquivo hosts ficará assim. O grupo win é onde será adicionada a instância após a criação: </p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=color:#ae81ff>localhost ansible_connection=local</span>

[<span style=color:#ae81ff>win]</span>

[<span style=color:#ae81ff>win:vars]</span>
<span style=color:#ae81ff>ansible_connection=winrm</span>
<span style=color:#ae81ff>ansible_ssh_port=5986</span>
<span style=color:#ae81ff>ansible_ssh_user=Administrator</span>
<span style=color:#ae81ff>ansible_ssh_pass=&#34;{{ win_initial_password }}&#34;</span>
<span style=color:#ae81ff>ansible_winrm_server_cert_validation=ignore</span>
</code></pre></div><p>Com essas váriaveis em mãos, vamos iniciar nossa instância base já usando o userdata assim como fizemos no painel da AWS, só que dessa vez diretamente pelo ansible: </p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=color:#75715e># cat roles/launch/tasks/main.yml</span>
- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Find Windows AMI base in this region</span>
  <span style=color:#f92672>ec2_ami_facts</span>:
    <span style=color:#f92672>owners</span>: <span style=color:#ae81ff>801119661308</span>
    <span style=color:#f92672>filters</span>:
      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Windows_Server-2019-English-Full-Base*</span>
  <span style=color:#f92672>register</span>: <span style=color:#ae81ff>found_amis</span>

- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Get AMI Windows</span>
  <span style=color:#f92672>set_fact</span>:
    <span style=color:#f92672>win_ami_id</span>: <span style=color:#e6db74>&#34;{{ (found_amis.images | first).image_id  }}&#34;</span>

- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Ensure security group is present</span>
  <span style=color:#f92672>ec2_group</span>:
    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>WinRM RDP</span>
    <span style=color:#f92672>description</span>: <span style=color:#ae81ff>Inbound WinRM and RDP</span>
    <span style=color:#f92672>region</span>: <span style=color:#e6db74>&#34;{{ target_aws_region }}&#34;</span>
    <span style=color:#f92672>vpc_id</span>: <span style=color:#e6db74>&#34;{{ vpc_id }}&#34;</span>
    <span style=color:#f92672>rules</span>:
    - <span style=color:#f92672>proto</span>: <span style=color:#ae81ff>tcp</span>
      <span style=color:#f92672>from_port</span>: <span style=color:#ae81ff>80</span>
      <span style=color:#f92672>to_port</span>: <span style=color:#ae81ff>80</span>
      <span style=color:#f92672>cidr_ip</span>: <span style=color:#ae81ff>0.0.0.0</span><span style=color:#ae81ff>/0</span>
    - <span style=color:#f92672>proto</span>: <span style=color:#ae81ff>tcp</span>
      <span style=color:#f92672>from_port</span>: <span style=color:#ae81ff>5986</span>
      <span style=color:#f92672>to_port</span>: <span style=color:#ae81ff>5986</span>
      <span style=color:#f92672>cidr_ip</span>: <span style=color:#ae81ff>0.0.0.0</span><span style=color:#ae81ff>/0</span>
    - <span style=color:#f92672>proto</span>: <span style=color:#ae81ff>tcp</span>
      <span style=color:#f92672>from_port</span>: <span style=color:#ae81ff>3389</span>
      <span style=color:#f92672>to_port</span>: <span style=color:#ae81ff>3389</span>
      <span style=color:#f92672>cidr_ip</span>: <span style=color:#ae81ff>0.0.0.0</span><span style=color:#ae81ff>/0</span>
    <span style=color:#f92672>rules_egress</span>:
    - <span style=color:#f92672>proto</span>: -<span style=color:#ae81ff>1</span>
      <span style=color:#f92672>cidr_ip</span>: <span style=color:#ae81ff>0.0.0.0</span><span style=color:#ae81ff>/0</span>
  <span style=color:#f92672>register</span>: <span style=color:#ae81ff>sg_out</span>

- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Ensure instances are running</span>
  <span style=color:#f92672>ec2</span>:
    <span style=color:#f92672>region</span>: <span style=color:#e6db74>&#34;{{ target_aws_region }}&#34;</span>
    <span style=color:#f92672>image</span>: <span style=color:#e6db74>&#34;{{ win_ami_id }}&#34;</span>
    <span style=color:#f92672>instance_type</span>: <span style=color:#e6db74>&#34;{{ instance_type }}&#34;</span>
    <span style=color:#f92672>group_id</span>: <span style=color:#e6db74>&#34;{{ sg_out.group_id }}&#34;</span>
    <span style=color:#f92672>key_name</span>: <span style=color:#e6db74>&#34;{{ keypair }}&#34;</span>
    <span style=color:#f92672>wait</span>: <span style=color:#66d9ef>yes</span>
    <span style=color:#f92672>wait_timeout</span>: <span style=color:#ae81ff>500</span>
    <span style=color:#f92672>exact_count</span>: <span style=color:#ae81ff>1</span>
    <span style=color:#f92672>assign_public_ip</span>: <span style=color:#66d9ef>yes</span>
    <span style=color:#f92672>vpc_subnet_id</span>: <span style=color:#e6db74>&#34;{{ subnet }}&#34;</span>
    <span style=color:#f92672>count_tag</span>:
      <span style=color:#f92672>Name</span>: <span style=color:#ae81ff>stock-win-ami-test</span>
    <span style=color:#f92672>instance_tags</span>:
      <span style=color:#f92672>Name</span>: <span style=color:#ae81ff>stock-win-ami-test</span>
    <span style=color:#f92672>user_data</span>: <span style=color:#e6db74>&#34;{{ lookup(&#39;template&#39;, &#39;userdata.txt.j2&#39;) }}&#34;</span>
  <span style=color:#f92672>register</span>: <span style=color:#ae81ff>ec2_result</span>

- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>wait for WinRM to answer on all hosts</span>
  <span style=color:#f92672>wait_for</span>:
    <span style=color:#f92672>port</span>: <span style=color:#ae81ff>5986</span>
    <span style=color:#f92672>host</span>: <span style=color:#e6db74>&#34;{{ item.public_ip }}&#34;</span>
    <span style=color:#f92672>delay</span>: <span style=color:#ae81ff>30</span>
    <span style=color:#f92672>timeout</span>: <span style=color:#ae81ff>300</span>
    <span style=color:#f92672>state</span>: <span style=color:#ae81ff>started</span>
  <span style=color:#f92672>with_items</span>: <span style=color:#e6db74>&#34;{{ ec2_result.tagged_instances }}&#34;</span>

- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>add hosts to groups</span>
  <span style=color:#f92672>add_host</span>:
    <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;win-temp-{{ item.id }}&#34;</span>
    <span style=color:#f92672>ansible_ssh_host</span>: <span style=color:#e6db74>&#34;{{ item.public_ip }}&#34;</span>
    <span style=color:#f92672>ec2_id</span>: <span style=color:#e6db74>&#34;{{ item.id }}&#34;</span>
    <span style=color:#f92672>groups</span>: <span style=color:#ae81ff>win</span>
  <span style=color:#f92672>changed_when</span>: <span style=color:#66d9ef>false</span>
  <span style=color:#f92672>with_items</span>: <span style=color:#e6db74>&#34;{{ ec2_result.tagged_instances }}&#34;</span>
</code></pre></div><p>Agora vamos conectar na instância e fazer a instalação do que precisamos, vamos contar com auxilio de um script para instalar o Chocolatey e algumas ferramentas (JDK e git) somente para exemplo.
Vamos também instalar algumas features do Windows como IIS, Powershell e .NET Framework, também somente para aprendizado. Também usaremos o módulo do Chocolatey para instalar o 7zip. </p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=color:#75715e># cat roles/deploy/tasks/main.yml</span>
- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Copy Script config</span>
  <span style=color:#f92672>win_copy</span>:
    <span style=color:#f92672>src</span>: <span style=color:#ae81ff>script.ps1</span>
    <span style=color:#f92672>dest</span>: <span style=color:#ae81ff>C:\Windows\Temp\script.ps1</span>

- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Execute script</span>
  <span style=color:#f92672>win_shell</span>: <span style=color:#ae81ff>C:\Windows\Temp\script.ps1</span>

- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>ensure IIS and ASP.NET are installed</span>
  <span style=color:#f92672>win_feature</span>:
    <span style=color:#f92672>name</span>:
      - <span style=color:#ae81ff>Web-Server</span>
      - <span style=color:#ae81ff>Web-Http-Redirect</span>
      - <span style=color:#ae81ff>Web-DAV-Publishing</span>
      - <span style=color:#ae81ff>Web-Custom-Logging</span>
      - <span style=color:#ae81ff>Web-Log-Libraries</span>
      - <span style=color:#ae81ff>Web-ODBC-Logging</span>
      - <span style=color:#ae81ff>Web-Request-Monitor</span>
      - <span style=color:#ae81ff>Web-Http-Tracing</span>
      - <span style=color:#ae81ff>Web-Dyn-Compression</span>
      - <span style=color:#ae81ff>Web-Basic-Auth</span>
      - <span style=color:#ae81ff>Web-CertProvider</span>
      - <span style=color:#ae81ff>Web-Client-Auth</span>
      - <span style=color:#ae81ff>Web-Digest-Auth</span>
      - <span style=color:#ae81ff>Web-Cert-Auth</span>
      - <span style=color:#ae81ff>Web-IP-Security</span>
      - <span style=color:#ae81ff>Web-Url-Auth</span>
      - <span style=color:#ae81ff>Web-Windows-Auth</span>
      - <span style=color:#ae81ff>Web-App-Dev</span>
      - <span style=color:#ae81ff>Web-Net-Ext</span>
      - <span style=color:#ae81ff>Web-Net-Ext45</span>
      - <span style=color:#ae81ff>Web-Asp-Net45</span>
      - <span style=color:#ae81ff>Web-ISAPI-Ext</span>
      - <span style=color:#ae81ff>Web-ISAPI-Filter</span>
      - <span style=color:#ae81ff>Web-Mgmt-Tools</span>
      - <span style=color:#ae81ff>Web-Scripting-Tools</span>
      - <span style=color:#ae81ff>Web-Mgmt-Console</span>
      - <span style=color:#ae81ff>Web-Mgmt-Service</span>
      - <span style=color:#ae81ff>NET-Framework-Features</span>
      - <span style=color:#ae81ff>NET-Framework-Core</span>
      - <span style=color:#ae81ff>NET-HTTP-Activation</span>
      - <span style=color:#ae81ff>NET-Non-HTTP-Activ</span>
      - <span style=color:#ae81ff>NET-Framework-45-Features</span>
      - <span style=color:#ae81ff>NET-Framework-45-Core</span>
      - <span style=color:#ae81ff>NET-Framework-45-ASPNET</span>
      - <span style=color:#ae81ff>NET-WCF-Services45</span>
      - <span style=color:#ae81ff>MSMQ</span>
      - <span style=color:#ae81ff>MSMQ-Services</span>
      - <span style=color:#ae81ff>MSMQ-Server</span>
      - <span style=color:#ae81ff>FS-SMB1</span>
      - <span style=color:#ae81ff>Telnet-Client</span>
      - <span style=color:#ae81ff>PowerShellRoot</span>
      - <span style=color:#ae81ff>PowerShell</span>
      - <span style=color:#ae81ff>PowerShell-V2</span>
      - <span style=color:#ae81ff>PowerShell-ISE</span>
      - <span style=color:#ae81ff>WAS</span>
      - <span style=color:#ae81ff>WAS-Process-Model</span>
      - <span style=color:#ae81ff>WAS-NET-Environment</span>
      - <span style=color:#ae81ff>WAS-Config-APIs</span>
      - <span style=color:#ae81ff>WoW64-Support</span>
    <span style=color:#f92672>state</span>: <span style=color:#ae81ff>present</span>
    <span style=color:#f92672>include_management_tools</span>: <span style=color:#66d9ef>yes</span>
  <span style=color:#f92672>register</span>: <span style=color:#ae81ff>windows_install</span>

- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Reboot if installing Web-Server feature requires it</span>
  <span style=color:#f92672>win_reboot</span>:
  <span style=color:#f92672>when</span>: <span style=color:#ae81ff>windows_install.reboot_required</span>

- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Install 7Zip</span>
  <span style=color:#f92672>win_chocolatey</span>:
    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>7zip</span>
    <span style=color:#f92672>state</span>: <span style=color:#ae81ff>present</span>
    
- <span style=color:#f92672>debug</span>:
    <span style=color:#f92672>msg</span>: <span style=color:#ae81ff>web application is available at http://{{ ansible_ssh_host }}/</span>
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=color:#75715e># cat roles/deploy/files/script.ps1</span>
<span style=color:#75715e># Install Chocolatey</span>
<span style=color:#ae81ff>iex ((New-Object System.Net.WebClient).DownloadString(&#39;https://chocolatey.org/install.ps1&#39;))</span>
<span style=color:#75715e># Globally Auto confirm every action</span>
<span style=color:#ae81ff>choco feature enable -n allowGalobalConfirmation</span>

<span style=color:#75715e># Install JDK 8 and git</span>
<span style=color:#ae81ff>choco install jdk8</span>
<span style=color:#ae81ff>choco install git</span>
</code></pre></div><p>Agora vamos gerar nossa AMI personalizada, lembrando que o nome deve ser sempre diferente ao gerar uma nova AMI, aqui é interessante incluir uma variável com o número do build do seu pipeline por exemplo: </p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=color:#75715e># cat roles/build-ami/tasks/main.yml</span>
- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Create AMI</span>
  <span style=color:#f92672>ec2_ami</span>:
    <span style=color:#f92672>region</span>: <span style=color:#e6db74>&#34;{{ target_aws_region }}&#34;</span>
    <span style=color:#f92672>instance_id</span>: <span style=color:#e6db74>&#34;{{ item.id }}&#34;</span>
    <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;windows-personalizado&#34;</span>
    <span style=color:#f92672>wait</span>: <span style=color:#66d9ef>yes</span>
    <span style=color:#f92672>state</span>: <span style=color:#ae81ff>present</span>
  <span style=color:#f92672>with_items</span>: <span style=color:#e6db74>&#34;{{ ec2_result.tagged_instances }}&#34;</span>
  <span style=color:#f92672>register</span>: <span style=color:#ae81ff>ami</span>

- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Set New AMI id variable</span>
  <span style=color:#f92672>set_fact</span>:
    <span style=color:#f92672>ami_result</span>: <span style=color:#e6db74>&#34;{{ (ami.results | first).image_id  }}&#34;</span>
</code></pre></div><p>Para não ficarmos com essa instância base rodando sem necessidade, vamos exclui-la: </p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=color:#75715e># cat roles/terminate/tasks/main.yml</span>
- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>ensure instances are not running</span>
  <span style=color:#f92672>ec2</span>:
    <span style=color:#f92672>region</span>: <span style=color:#e6db74>&#34;{{ target_aws_region }}&#34;</span>
    <span style=color:#f92672>image</span>: <span style=color:#e6db74>&#34;{{ win_ami_id }}&#34;</span>
    <span style=color:#f92672>instance_type</span>: <span style=color:#e6db74>&#34;{{ instance_type }}&#34;</span>
    <span style=color:#f92672>group_id</span>: <span style=color:#e6db74>&#34;{{ sg_out.group_id }}&#34;</span>
    <span style=color:#f92672>key_name</span>: <span style=color:#e6db74>&#34;{{ keypair }}&#34;</span>
    <span style=color:#f92672>wait</span>: <span style=color:#66d9ef>yes</span>
    <span style=color:#f92672>wait_timeout</span>: <span style=color:#ae81ff>500</span>
    <span style=color:#f92672>exact_count</span>: <span style=color:#ae81ff>0</span>
    <span style=color:#f92672>assign_public_ip</span>: <span style=color:#66d9ef>yes</span>
    <span style=color:#f92672>vpc_subnet_id</span>: <span style=color:#e6db74>&#34;{{ subnet }}&#34;</span>
    <span style=color:#f92672>count_tag</span>:
      <span style=color:#f92672>Name</span>: <span style=color:#ae81ff>stock-win-ami-test</span>
    <span style=color:#f92672>instance_tags</span>:
      <span style=color:#f92672>Name</span>: <span style=color:#ae81ff>stock-win-ami-test</span>
  <span style=color:#f92672>register</span>: <span style=color:#ae81ff>ec2_result</span>
</code></pre></div><p>Então nosso arquivo principal para realizarmos essa tarega ficará assim: </p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=color:#75715e># cat deploy.yml</span>
- <span style=color:#f92672>hosts</span>: <span style=color:#ae81ff>localhost</span>
  <span style=color:#f92672>gather_facts</span>: <span style=color:#66d9ef>no</span>
  <span style=color:#f92672>roles</span>:
    - <span style=color:#f92672>role</span>: <span style=color:#ae81ff>launch</span>
      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>win</span>

- <span style=color:#f92672>hosts</span>: <span style=color:#ae81ff>win</span>
  <span style=color:#f92672>roles</span>:
    - <span style=color:#ae81ff>deploy</span>

- <span style=color:#f92672>hosts</span>: <span style=color:#ae81ff>localhost</span>
  <span style=color:#f92672>gather_facts</span>: <span style=color:#66d9ef>no</span>
  <span style=color:#f92672>connection</span>: <span style=color:#ae81ff>local</span>
  <span style=color:#f92672>roles</span>:
    - <span style=color:#ae81ff>build-ami</span>
    - <span style=color:#ae81ff>terminate</span>
</code></pre></div><p>E para rodar tudo e ser feliz basta executar: <em><strong>ansible-playbook -i hosts deploy.yml</strong></em></p>
<p><strong>Iniciando a execução:</strong></p>
<p><img src=https://sidneiweber.github.io/img/aws-ami/1.png alt="Iniciando Instância"></p>
<p><strong>Instância rodando na AWS:</strong></p>
<p><img src=https://sidneiweber.github.io/img/aws-ami/5.png alt="Instância iniciada"></p>
<p><strong>Instalando aplicações e configurações:</strong></p>
<p><img src=https://sidneiweber.github.io/img/aws-ami/2.png alt="Realizando deploy das aplicações"></p>
<p><strong>Gerando a AMI e encerrando a instância base:</strong></p>
<p><img src=https://sidneiweber.github.io/img/aws-ami/3.png alt="Gerando a AMI e encerrando instância"></p>
<p><strong>AMI gerada no painel da AWS:</strong></p>
<p><img src=https://sidneiweber.github.io/img/aws-ami/6.png alt="AMI gerada"></p>
<p><strong>Resumo das execuções no Ansible:</strong></p>
<p><img src=https://sidneiweber.github.io/img/aws-ami/4.png alt="Resumo das execuções"></p>
<p>Referencia: <a href=http://blog.rolpdog.com/2015/09/manage-stock-windows-amis-with-ansible_3.html>http://blog.rolpdog.com/2015/09/manage-stock-windows-amis-with-ansible_3.html</a></p>
</div>
</article>
<hr>
<div class=post-info>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=https://sidneiweber.github.io/tags/aws/>aws</a></span>
<span class=tag><a href=https://sidneiweber.github.io/tags/ansible/>ansible</a></span>
<span class=tag><a href=https://sidneiweber.github.io/tags/windows/>windows</a></span>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
955 Words
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
2019-12-27 17:04
</p>
</div>
<hr>
<div class=sharing-buttons>
<a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsidneiweber.github.io%2fansible-criado-ami-windows-personalizada-na-aws-parte-2%2f" target=_blank rel=noopener aria-label title="Share on facebook">
<div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fsidneiweber.github.io%2fansible-criado-ami-windows-personalizada-na-aws-parte-2%2f" target=_blank rel=noopener aria-label title="Share on twitter">
<div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://www.tumblr.com/widgets/share/tool?posttype=link&title=Ansible%3a%20Criado%20AMI%20Windows%20personalizada%20na%20AWS%20%28Parte%202%29&caption=Ansible%3a%20Criado%20AMI%20Windows%20personalizada%20na%20AWS%20%28Parte%202%29&canonicalUrl=https%3a%2f%2fsidneiweber.github.io%2fansible-criado-ami-windows-personalizada-na-aws-parte-2%2f" target=_blank rel=noopener aria-label title="Share on tumblr">
<div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093.0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941.0 9.999.0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="mailto:?subject=Ansible%3a%20Criado%20AMI%20Windows%20personalizada%20na%20AWS%20%28Parte%202%29&body=https%3a%2f%2fsidneiweber.github.io%2fansible-criado-ami-windows-personalizada-na-aws-parte-2%2f" target=_self rel=noopener aria-label title="Share via email">
<div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fsidneiweber.github.io%2fansible-criado-ami-windows-personalizada-na-aws-parte-2%2f&media=https%3a%2f%2fsidneiweber.github.io%2fansible-criado-ami-windows-personalizada-na-aws-parte-2%2f;description=Ansible%3a%20Criado%20AMI%20Windows%20personalizada%20na%20AWS%20%28Parte%202%29" target=_blank rel=noopener aria-label title="Share on pinterest">
<div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12.017.0C5.396.0.029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024.0 1.518.769 1.518 1.688.0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128.0 3.768-2.245 3.768-5.487.0-2.861-2.063-4.869-5.008-4.869-3.41.0-5.409 2.562-5.409 5.199.0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646.0-3.776 2.748-7.252 7.92-7.252 4.158.0 7.392 2.967 7.392 6.923.0 4.135-2.607 7.462-6.233 7.462-1.214.0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607.0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017.0z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fsidneiweber.github.io%2fansible-criado-ami-windows-personalizada-na-aws-parte-2%2f&title=Ansible%3a%20Criado%20AMI%20Windows%20personalizada%20na%20AWS%20%28Parte%202%29&summary=Ansible%3a%20Criado%20AMI%20Windows%20personalizada%20na%20AWS%20%28Parte%202%29&source=https%3a%2f%2fsidneiweber.github.io%2fansible-criado-ami-windows-personalizada-na-aws-parte-2%2f" target=_blank rel=noopener aria-label title="Share on linkedin">
<div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2fsidneiweber.github.io%2fansible-criado-ami-windows-personalizada-na-aws-parte-2%2f&resubmit=true&title=Ansible%3a%20Criado%20AMI%20Windows%20personalizada%20na%20AWS%20%28Parte%202%29" target=_blank rel=noopener aria-label title="Share on reddit">
<div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2fsidneiweber.github.io%2fansible-criado-ami-windows-personalizada-na-aws-parte-2%2f;title=Ansible%3a%20Criado%20AMI%20Windows%20personalizada%20na%20AWS%20%28Parte%202%29" target=_blank rel=noopener aria-label title="Share on xing">
<div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M18.188.0c-.517.0-.741.325-.927.66.0.0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211.0.375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016.0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894.0 21.686.0h-3.498zM3.648 4.74c-.211.0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016.0.021L1.86 16.051c-.099.188-.093.381.0.529.085.142.239.234.45.234h3.461c.518.0.766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="whatsapp://send?text=Ansible%3a%20Criado%20AMI%20Windows%20personalizada%20na%20AWS%20%28Parte%202%29%20https%3a%2f%2fsidneiweber.github.io%2fansible-criado-ami-windows-personalizada-na-aws-parte-2%2f" target=_blank rel=noopener aria-label title="Share on whatsapp">
<div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893a11.821 11.821.0 00-3.48-8.413z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fsidneiweber.github.io%2fansible-criado-ami-windows-personalizada-na-aws-parte-2%2f&t=Ansible%3a%20Criado%20AMI%20Windows%20personalizada%20na%20AWS%20%28Parte%202%29" target=_blank rel=noopener aria-label title="Share on hacker news">
<div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://telegram.me/share/url?text=Ansible%3a%20Criado%20AMI%20Windows%20personalizada%20na%20AWS%20%28Parte%202%29&url=https%3a%2f%2fsidneiweber.github.io%2fansible-criado-ami-windows-personalizada-na-aws-parte-2%2f" target=_blank rel=noopener aria-label title="Share on telegram">
<div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
</div>
</div>
</a>
</div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h></span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=https://sidneiweber.github.io/como-redimensionar-volume-ebs-no-linux-sem-downtime/>
<span class=button__icon>←</span>
<span class=button__text>Como redimensionar volume EBS no Linux sem downtime</span>
</a>
</span>
<span class="button next">
<a href=https://sidneiweber.github.io/ansible-criado-ami-windows-personalizada-na-aws-parte-1/>
<span class=button__text>Ansible: Criado AMI Windows personalizada na AWS (Parte 1)</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
<div id=comments>
<div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//sidneiweber.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</div>
</main>
</div>
<footer class=footer>
<div class=footer__inner>
<div class=footer__content>
<span>&copy; 2021</span>
<span><a href=https://sidneiweber.github.io>Sidnei Weber</a></span>
<span><a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a></span><span><a href=https://sidneiweber.github.io/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span>
</div>
</div>
<div class=footer__inner>
<div class=footer__content>
<span>Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>Made with &#10084; by <a href=https://github.com/rhazdon>Djordje Atlialp</a></span>
</div>
</div>
</footer>
</div>
<script type=text/javascript src=https://sidneiweber.github.io/bundle.min.2ce64ea6ea44a72b13dd812fc2eb5cca3efe878cce258a47c137c17edf46e0602a05e422b618a5b80b5939c731b7a293351c2f2222a21f6ee27e54a8448dd20e.js integrity="sha512-LOZOpupEpysT3YEvwutcyj7+h4zOJYpHwTfBft9G4GAqBeQithiluAtZOccxt6KTNRwvIiKiH27iflSoRI3SDg=="></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-921545-12','auto'),ga('send','pageview'))</script>
</body>
</html>